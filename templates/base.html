<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}FlowWork{% endblock %}</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap 5.3 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Awesome 6 -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet">

    <style>
        body {
            margin: 0;
            background-color: #f8f9fa;
            color: #000;
        }

        /* ===== LAYOUT DESKTOP ===== */
        .layout {
            display: flex;
        }

        /* ===== SIDEBAR FIXA ===== */
        .sidebar {
            width: 280px;
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            overflow-y: auto;
            box-shadow: inset -5px 0 10px -5px rgba(0,0,0,0.2);
            background: #fff;
        }

        .sidebar a {
            color: #000;
        }

        .sidebar a.active {
            background-color: #041955;
            color: #fff;
            font-weight: bold;
        }

        /* Logo desktop */
        .sidebar-logo {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .sidebar-logo img {
            max-width: 180px;
            height: auto;
        }

        /* ===== CONTEÚDO ===== */
        .content {
            margin-left: 280px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        main {
            flex: 1;
        }

        /* ===== MOBILE ===== */
        .bottom-nav {
            display: none;
            background: #fff;
            border-top: 1px solid #ddd;
            z-index: 1000;
        }

        .bottom-nav a {
            color: #000;
            text-decoration: none;
            flex: 1;
            text-align: center;
            padding: 8px 0;
            font-size: 12px;
            border-bottom: 1px solid #ddd;
            border-radius: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .bottom-nav a.active {
            background-color: #041955;
            color: #fff;
        }

        .bottom-nav a i {
            font-size: 18px;
            margin-bottom: 2px;
        }

        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }

            .content {
                margin-left: 0;
            }

            .bottom-nav {
                display: flex;
                position: fixed;
                bottom: 0;
                left: 0;
                width: 100%;
            }

            main {
                padding-bottom: 100px; /* espaço para nav mobile */
            }
        }
    </style>
</head>

<body>

<!-- ===== SIDEBAR DESKTOP ===== -->
<aside class="sidebar d-none d-md-flex flex-column p-3">

    <!-- Logo -->
    <div class="sidebar-logo">
        <img src="{{ url_for('static', filename='img/logo-login.png') }}" alt="Logo FlashPoint">
    </div>

    <hr>

    <ul class="nav nav-pills flex-column mb-auto">
        <li class="nav-item">
            <a href="/dashboard" class="nav-link {% if request.path == '/dashboard' %}active{% endif %}">
                <i class="fa fa-home me-2"></i> Home
            </a>
        </li>

        <li>
            <a href="{{ url_for('registrar_ponto_usuario') }}" class="nav-link {% if request.path == '/registrar_ponto' %}active{% endif %}">
                <i class="fa fa-plus-square me-2"></i> Segna Ore
            </a>
        </li>

        <li>
            <a href="/meus_pontos" class="nav-link {% if request.path == '/meus_pontos' %}active{% endif %}">
                <i class="fa fa-clock me-2"></i> Mie Ore
            </a>
        </li>

        <li>
            <a href="{{ url_for('novo_pedido') }}" class="nav-link {% if request.path == '/pedido/novo' %}active{% endif %}">
                <i class="fa fa-folder-open me-2"></i> Mie Richeste
            </a>
        </li>

        <li>
            <a href="/perfil" class="nav-link {% if request.path == '/perfil' %}active{% endif %}">
                <i class="fa fa-user me-2"></i> Profilo
            </a>
        </li>

        <!-- ===== ITEM ADMIN COLLAPSIBLE ===== -->
        {% if usuario.tipo == 'admin' %}
        <li class="border-top my-3"></li>

        <!-- Administração -->
        <li class="mb-1">
            <button class="btn btn-toggle d-flex align-items-center w-100 rounded border-0 px-2"
                    data-bs-toggle="collapse"
                    data-bs-target="#admin-collapse"
                    aria-expanded="false">

                <!-- Ícone + texto -->
                <span class="d-flex align-items-center gap-2">
                    <i class="fa fa-desktop"></i>
                    Amministrazione
                </span>

                <!-- Seta à direita -->
                <i class="fa fa-angle-right ms-auto"></i>
            </button>

            <div class="collapse" id="admin-collapse">
                <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small ps-4">

                    <li>
                        <a href="{{ url_for('admin_pontos') }}"
                        class="link-body-emphasis d-inline-flex align-items-center gap-2 text-decoration-none rounded">
                            <i class="fa fa-users"></i>
                            Gestione delle ore registrate
                        </a>
                    </li>

                    <li>
                        <a href="/adm_locais"
                        class="link-body-emphasis d-inline-flex align-items-center gap-2 text-decoration-none rounded">
                            <i class="fa fa-institution"></i>
                            Gestione dei cantieri
                        </a>
                    </li>

                    <li>
                        <a href="{{ url_for('admin_cartoes') }}"
                        class="link-body-emphasis d-inline-flex align-items-center gap-2 text-decoration-none rounded">
                            <i class="fa fa-id-badge"></i>
                            Tesserini
                        </a>
                    </li>

                    <li>
                        <a href="{{ url_for('admin_pedidos') }}"
                        class="link-body-emphasis d-inline-flex align-items-center gap-2 text-decoration-none rounded">
                            <i class="fa fa-folder"></i>
                            Richesta degli dipendenti
                        </a>
                    </li>

                </ul>
            </div>
        </li>
        {% endif %}

        <!-- ===== ITEM ACCOUNT COLLAPSIBLE ===== -->
        <script>
        document.querySelectorAll('.btn-toggle').forEach(btn => {
            const icon = btn.querySelector('.fa-angle-right, .fa-angle-down');
            const target = document.querySelector(btn.dataset.bsTarget);

            target.addEventListener('show.bs.collapse', () => {
                icon.classList.remove('fa-angle-right');
                icon.classList.add('fa-angle-down');
            });

            target.addEventListener('hide.bs.collapse', () => {
                icon.classList.remove('fa-angle-down');
                icon.classList.add('fa-angle-right');
            });
        });
        </script>

    </ul>

    <hr>

    <a href="/logout" class="btn btn-outline-secondary btn-sm mb-3">
        <i class="fa fa-sign-out-alt"></i> Sair
    </a>
</aside>

<!-- ===== CONTEÚDO ===== -->
<div class="content">
    <main class="p-4">
        {% block content %}{% endblock %}
    </main>

    <!-- ===== FOOTER ===== -->
    <footer class="border-top py-3 mt-auto">
        <div class="container d-flex justify-content-between align-items-center">
            <span class="text-body-secondary">© 2026 FlashPoint</span>
        </div>
    </footer>
</div>

<!-- ===== BOTTOM NAV MOBILE ===== -->
<nav class="bottom-nav d-md-none">
    <ul class="nav nav-pills nav-flush flex-row w-100 mb-0 text-center">
        <li class="nav-item flex-fill">
            <a href="/dashboard" class="nav-link py-3 {% if request.path == '/dashboard' %}active{% endif %}" data-bs-toggle="tooltip" data-bs-placement="top" aria-label="Home">
                <i class="fa fa-home d-block" width="30" height="30"></i>
            </a>
        </li>
        <li class="nav-item flex-fill">
            <a href="{{ url_for('registrar_ponto_usuario') }}" class="nav-link py-3 {% if request.path == '/registrar_ponto' %}active{% endif %}" data-bs-toggle="tooltip" data-bs-placement="top" aria-label="Novo Ponto">
                <i class="fa fa-plus-square d-block" width="30" height="30"></i>
            </a>
        </li>
        <li class="nav-item flex-fill">
            <a href="/meus_pontos" class="nav-link py-3 {% if request.path == '/meus_pontos' %}active{% endif %}" data-bs-toggle="tooltip" data-bs-placement="top" aria-label="Meus Pontos">
                <i class="fa fa-clock d-block" width="30" height="30"></i>
            </a>
        </li>
                <li class="nav-item flex-fill">
            <a href="{{ url_for('novo_pedido') }}" class="nav-link py-3 {% if request.path == '/pedido/novo' %}active{% endif %}" data-bs-toggle="tooltip" data-bs-placement="top" aria-label="Novo Pedido">
                <i class="fa fa-folder-open d-block" width="30" height="30"></i>
            </a>
        </li>
        <li class="nav-item flex-fill">
            <a href="/perfil" class="nav-link py-3 {% if request.path == '/perfil' %}active{% endif %}" data-bs-toggle="tooltip" data-bs-placement="top" aria-label="Perfil">
                <i class="fa fa-user d-block" width="30" height="30"></i>
            </a>
        </li>


    </ul>
</nav>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
